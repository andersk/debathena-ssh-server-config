# If a user logs in without tickets and tokens, display a warning message to let them know

# Check to make sure the user does not have a local account
if [ "$DEBATHENA_HOME_TYPE" == "afs" ]; then
    # Check to make sure it's an interactive logon
    if [ "$PS1" ]; then
        tickets=
        tokens=

        # Check for tokens
        if tokens | grep -q 'athena\.mit\.edu'; then
            tokens="yes"
        fi

        # Check for tickets
        if klist -s; then
            tickets="yes"
        fi

        if [ -z "$tokens" ] && [ -z "$tickets" ] && [ ! -r ~/.bashrc ]; then
            echo "WARNING: You have no valid Kerberos tickets and no valid AFS tokens." >&2
            echo "See http://debathena.mit.edu/ssh" >&2
        elif [ -z "$tokens" ] && [ ! -r ~/.bashrc ]; then
            echo "WARNING: You have no valid AFS tokens." >&2
            echo "See http://debathena.mit.edu/ssh" >&2
        elif [ -z "$tickets" ]; then
            echo "WARNING: You have no valid Kerberos tickets." >&2
            echo "See http://debathena.mit.edu/ssh" >&2
        fi
    fi
fi
